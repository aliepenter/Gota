<link rel="stylesheet" type="text/css" href="{{ 'app_style.css' | asset_url }}"/>
<!-- <script type="text/javascript" src="{{ 'instagram.js' | asset_url }}" defer="defer"></script>
 -->


<section id="section_instagram">
  {%- if section.settings.heading -%}
    <h2>{{ section.settings.heading }}</h2>
  {%- endif -%}
  
  {%- if section.settings.description -%}
    <p>{{ section.settings.description }}</p>
  {%- endif -%}
  <div  id="bst-instagram" 
        data-autoplay="{{ section.settings.autoplay }}"
        data-speed="{{ section.settings.autoplay-speed }}"
        data-loop="{{ section.settings.loop }}"
        data-arrows="{{ section.settings.arrows }}"
        data-dots="{{ section.settings.dots }}"
        data-rows="{{ section.settings.rows }}"
        data-margin="{{ section.settings.margin }}"
  >
  </div>
</section>
<script>
  const bstInstagram = document.querySelector('#bst-instagram')
  fetch('http://localhost:3333/instagram/')
    .then(response => response.json())
    .then(data => {
        data.forEach(element => {
            bstInstagram.innerHTML += 
                `<div class="item-bst">
                    <a href="${element.permalink}">
                        <img src="${element.media_url}" alt/>
                    </a>
                </div>`
        })

        
    })
    .then(result => {
      const autoplay = $('#bst-instagram').data("autoplay");
      const speed = $('#bst-instagram').data("speed");
      const loop = $('#bst-instagram').data("loop");
      const arrows = $('#bst-instagram').data("arrows");
      const dots = $('#bst-instagram').data("dots");
      const rows = $('#bst-instagram').data("rows");
      const margin = $('#bst-instagram').data("margin");
      $('#bst-instagram').slick({
          infinite: loop,
          slidesToShow: 3,
          slidesToScroll: 1,
          arrows: arrows,
          dots: dots,
          rows: rows,
          autoplay: autoplay,
          autoplaySpeed: speed,
      });
      $('.item-bst').css('padding-left',margin)
      $('.item-bst').css('padding-right',margin)
    })
</script>
{% schema %}
  {
    "name": "Instagram",
    "tag": "section",
    "class": "section",
    "settings": [
      {
        "type": "text",
        "id": "heading",
        "label": "Heading",
        "default": "Instagram"
      },
      {
        "type": "text",
        "id": "description",
        "label": "Description",
        "default": "Make your Instagram shop"
      },
      {
        "type": "checkbox",
        "id": "autoplay",
        "label": "Autoplay",
        "default": false
      },
      {
        "type": "number",
        "id": "autoplay-speed",
        "label": "Autoplay Speed",
        "default": 2000
      },
      {
        "type": "checkbox",
        "id": "loop",
        "label": "Infinite Loop",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "arrows",
        "label": "Show Arrows",
        "default": false
      },
      {
        "type": "checkbox",
        "id": "dots",
        "label": "Show Dots",
        "default": false
      },
      {
        "type": "select",
        "id": "rows",
        "label": "Rows",
        "options": [
          {
            "value": "1",
            "label": "1"
          },
          {
            "value": "2",
            "label": "2"
          },
          {
            "value": "3",
            "label": "3"
          },
          {
            "value": "4",
            "label": "4"
          },
          {
            "value": "5",
            "label": "5"
          },
          {
            "value": "6",
            "label": "6"
          }
        ],
        "default": "2"
      },
      {
        "type": "select",
        "id": "margin",
        "label": "Margin",
        "options": [
          {
            "value": "0px",
            "label": "0px"
          },
          {
            "value": "10px",
            "label": "10px"
          },
          {
            "value": "20px",
            "label": "20px"
          },
          {
            "value": "30px",
            "label": "30px"
          },
          {
            "value": "40px",
            "label": "40px"
          }
        ],
        "default": "10px"
      }
    ],
    "presets": [{
      "name": "Instagram"
    }]
  }
{% endschema %}